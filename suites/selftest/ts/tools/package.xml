<?xml version="1.0"?>
<!-- SPDX-License-Identifier: Apache-2.0 -->
<!-- Copyright (C) 2023 OKTET Labs Ltd. All rights reserved. -->
<package version="1.0">
    <description>Package for self-tests of lib/tool functions</description>
    <author mailto="Artem.Andreev@oktetlabs.ru"/>

    <session>
        <run>
            <script name="readlink"/>
        </run>

        <run>
            <script name="resolvepath"/>
        </run>

        <run>
            <script name="base64"/>
            <arg name="n_iterations">
                <value>1000</value>
            </arg>
            <arg name="min_len">
                <value>1</value>
            </arg>
            <arg name="max_len">
                <value>128</value>
            </arg>
            <arg name="url_safe">
                <value>FALSE</value>
                <value>TRUE</value>
            </arg>
        </run>

        <run name="bufs">
            <session>
                <run>
                    <script name="compare_bufs"/>
                </run>

                <run>
                    <script name="make_bufs"/>
                    <arg name="n_iterations">
                        <value>1000</value>
                    </arg>
                    <arg name="min_len">
                        <value>1</value>
                    </arg>
                    <arg name="max_len">
                        <value>128</value>
                    </arg>
                </run>
            </session>
        </run>

        <run>
            <script name="enum_map"/>
        </run>

        <run name="expansion">
            <session>
                <run>
                    <script name="expand"/>
                    <arg name="template">
                        <value>var1=${var1} var2=${var2:-unknown} pos=${0} unknown=${unknown:-${var2}} known=${var2:+known} nested=${var2:+${unknown:-${var1}}} notempty=${var2|notempty:-empty} end</value>
                    </arg>
                    <arg name="var1" list="">
                        <value>value1</value>
                        <value>-</value>
                    </arg>
                    <arg name="var2" list="">
                        <value>value2</value>
                        <value>-</value>
                    </arg>
                    <arg name="posarg" list="">
                        <value>positional</value>
                    </arg>
                    <arg name="expanded" list="">
                        <value>var1=value1 var2=value2 pos=positional unknown=value2 known=known nested=value1 notempty=value2 end</value>
                        <value>var1= var2= pos=positional unknown= known=known nested= notempty=empty end</value>
                    </arg>
                </run>
                <run>
                    <script name="expand_filters" />
                    <arg name="input" list="">
                        <value>test~~</value>
                        <value>test~~</value>
                        <value>test&#x0a;&#x09;</value>
                        <value>test string 123.</value>
                        <value>-</value>
                        <value>test &#x0a;&#x0d;&#x0a;</value>
                        <value>test&#x0a;</value>
                        <value>test &quot;/&#x0a;</value>
                        <value>test</value>
                        <value>-</value>
                        <value> test &#x09;  &#x0a; 123&#x0a; </value>
                        <value>&#x0a;&#x09;</value>
                        <value>test &apos; 123</value>
                        <value>-</value>
                        <value>test123</value>
                        <value>test: 123/456~</value>
                        <value>&lt;tag param=&quot;&amp;lt;&quot;&gt;&#x0a;</value>
                        <value>klmno</value>
                    </arg>
                    <arg name="filter" list="">
                        <value>base64</value>
                        <value>base64uri</value>
                        <value>c</value>
                        <value>cid</value>
                        <value>cid</value>
                        <value>crlf|c</value>
                        <value>hex</value>
                        <value>json</value>
                        <value>length</value>
                        <value>length</value>
                        <value>normalize</value>
                        <value>normalize</value>
                        <value>shell</value>
                        <value>shell</value>
                        <value>upper</value>
                        <value>uri</value>
                        <value>xml</value>
                        <value>upper|hex|upper|base64</value>
                    </arg>
                    <arg name="filtered" list="">
                        <value>dGVzdH5+</value>
                        <value>dGVzdH5-</value>
                        <value>test\n\t</value>
                        <value>test_string_123_</value>
                        <value>_</value>
                        <value>test \r\n\r\n</value>
                        <value>746573740a</value>
                        <value>&quot;test \&quot;\/\n&quot;</value>
                        <value>4</value>
                        <value>0</value>
                        <value>test 123</value>
                        <value>-</value>
                        <value>&apos;test &apos;\&apos;&apos; 123&apos;</value>
                        <value>&apos;&apos;</value>
                        <value>TEST123</value>
                        <value>test%3A%20123%2F456~</value>
                        <value>&amp;lt;tag param=&amp;quot;&amp;amp;lt;&amp;quot;&amp;gt;&amp;#xa;</value>
                        <value>NEI0QzRENEU0Rg==</value>
                    </arg>
                </run>
            </session>
        </run>

        <run>
            <script name="extract_glob"/>
            <arg name="filename">
                <value>/dir/name.suffix</value>
            </arg>
            <arg name="pattern" list="">
                <value>*</value>
                <value>/dir/*</value>
                <value>name.*</value>
                <value>*.suffix</value>
                <value>n*x</value>
                <value>/*/name.suffix</value>
                <value>nomatch</value>
                <value>nomatch.*</value>
                <value>????.*</value>
                <value>[nN][[:alpha:]][m-x][][:alpha:][:digit:]]*su[f-h][[:alpha:]]\ix</value>
                <!-- invalid glob patterns won't match -->
                <value>name.*\</value>
                <value>name.*[x-</value>
                <!-- The following values are marked as broken because they would
                     trigger a fatal error -->
                <value reqs="BROKEN">*.*</value>
                <value reqs="BROKEN">name.suffix</value>
            </arg>
            <arg name="expect_full" list="">
                <value>NULL</value>
                <value>name.suffix</value>
                <value>NULL</value>
                <value>NULL</value>
                <value>NULL</value>
                <value>dir</value>
                <value>NULL</value>
                <value>NULL</value>
                <value>NULL</value>
                <value>NULL</value>
                <value>NULL</value>
                <value>NULL</value>
            </arg>
            <arg name="expect_base" list="">
                <value>name.suffix</value>
                <value>NULL</value>
                <value>suffix</value>
                <value>name</value>
                <value>ame.suffi</value>
                <value>NULL</value>
                <value>NULL</value>
                <value>NULL</value>
                <value>suffix</value>
                <value>.</value>
                <value>NULL</value>
                <value>NULL</value>
            </arg>
        </run>

        <run>
            <script name="file"/>
            <arg name="content">
                <value>Test data</value>
            </arg>
            <arg name="binary">
                <value>FALSE</value>
                <value>TRUE</value>
            </arg>
        </run>

        <run>
            <script name="hexdump"/>
        </run>

        <run>
            <script name="intset"/>
        </run>

        <run>
            <script name="json"/>
            <arg name="use_file" type="boolean"/>
        </run>

        <run>
            <script name="kvpair" />
            <arg name="n_keys"><value>1000</value></arg>
            <arg name="min_key_len"><value>1</value></arg>
            <arg name="max_key_len"><value>1024</value></arg>
            <arg name="min_value_len"><value>1</value></arg>
            <arg name="max_value_len"><value>65536</value></arg>
        </run>

        <run>
            <script name="scandir"/>
            <arg name="n_files">
                <value>10</value>
            </arg>
        </run>

        <run>
            <script name="str_compare_versions"/>
        </run>

        <run>
            <script name="string"/>
        </run>

        <run>
            <package name="timer"/>
        </run>

        <run>
            <script name="units"/>
        </run>

        <run>
            <script name="uri"/>
        </run>

        <run>
            <script name="vector"/>
        </run>

        <run>
            <script name="vector_search"/>
        </run>
    </session>
</package>
